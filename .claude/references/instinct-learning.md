# Instinct Learning System

작업 세션에서 반복되는 패턴을 자동 감지하고, 신뢰도 기반으로 Persistent Context에 반영하는 시스템입니다.

---

## 개념

```
Instinct = 반복 관찰된 패턴 + 신뢰도 점수

세션 관찰 → 후보 기록 → 반복 확인 → 신뢰도 상승 → Persistent Context 반영
```

Persistent Context 업데이트의 "2+ 세션 증거 임계값" 규칙을 구조화한 것입니다.

---

## 패턴 유형

| 유형 | 예시 | 반영 대상 |
|------|------|-----------|
| 코딩 스타일 | 화살표 함수 선호, early return 패턴 | conventions.md |
| 기술 선택 | Zustand 선호, Prisma ORM 사용 | tech-stack.md |
| 워크플로우 | 리뷰 전 항상 린트 실행 | preferences.md |
| 커뮤니케이션 | 한국어 선호, 간결한 설명 선호 | preferences.md |
| 에러 패턴 | 특정 라이브러리 반복 이슈 | conventions.md (주의사항) |

---

## 신뢰도 체계

| 레벨 | 점수 | 조건 | 상태 |
|------|------|------|------|
| 후보 | 0.3 | 1회 관찰 | notepads에 기록 |
| 유력 | 0.6 | 2회 관찰 | Persistent Context 반영 검토 |
| 확정 | 0.9 | 3회+ 또는 사용자 명시 | Persistent Context 확정 |

### 점수 변동

```
+0.3: 같은 패턴 재관찰
+0.6: 사용자가 명시적으로 선호 표현 → 즉시 확정 (0.9)
-0.2: 반대 패턴 관찰
-0.5: 사용자가 명시적으로 거부
```

---

## 기록 포맷

### .claude/memory/notepads/instincts.md

```markdown
# Instinct 후보

## 코딩 스타일
- [0.3] 화살표 함수 선호 (2025-01-15 관찰)
- [0.6] early return 패턴 (2025-01-15, 2025-01-18 관찰)
- [0.9] 한국어 변수명 금지 (2025-01-15 사용자 명시)

## 기술 선택
- [0.6] 상태 관리: Zustand (2025-01-16, 2025-01-20 관찰)

## 워크플로우
- [0.3] 커밋 전 tsc --noEmit 실행 (2025-01-18 관찰)
```

---

## 오케스트레이터 절차

### 관찰 시점

```
1. 코드 리뷰 피드백에서 반복 지적 사항
2. 사용자의 수정 요청 패턴 (같은 종류의 변경을 반복 요청)
3. 사용자의 명시적 선호 표현 ("나는 ~를 선호해", "항상 ~해줘")
4. 에이전트 실패 후 성공 패턴 (어떤 접근이 효과적이었는지)
```

### 기록 절차

```
1. 패턴 감지 → instincts.md에서 기존 항목 검색
2. 기존 항목 있음 → 점수 +0.3, 관찰 날짜 추가
3. 기존 항목 없음 → 새 항목 추가 (점수 0.3)
4. 점수 >= 0.6 → Persistent Context 반영 검토
5. 점수 >= 0.9 → Persistent Context에 확정 반영
6. 반영 완료 → instincts.md에서 해당 항목에 "→ 반영됨" 표시
```

### 반영 예시

```
instincts.md:
  [0.6] early return 패턴 (2회 관찰)

→ conventions.md에 추가:
  ## 코드 스타일
  - early return 패턴 사용 (중첩 조건 대신)
```

---

## 세션 종료 시 체크리스트

워크플로우 완료 시 오케스트레이터가 실행:

```
1. 이번 세션에서 새로 관찰된 패턴이 있는가?
   → 있으면 instincts.md 업데이트

2. 기존 후보 중 이번 세션에서 재확인된 것이 있는가?
   → 있으면 점수 상향

3. 점수 >= 0.6인 항목 중 미반영 건이 있는가?
   → 있으면 Persistent Context 반영

4. 사용자가 명시적으로 거부한 패턴이 있는가?
   → 있으면 점수 하향 또는 삭제
```

---

## 주의사항

- instincts.md는 **오케스트레이터만** 수정 (에이전트는 읽기만)
- 프로젝트별 패턴만 기록 (범용 코딩 상식은 기록하지 않음)
- 신뢰도가 낮은 항목(0.3)으로 에이전트 행동을 변경하지 않음
- Persistent Context 반영 시 출처(instinct)를 주석으로 남기지 않음 (확정된 것은 정식 컨벤션)
