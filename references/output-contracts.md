# Output Contracts (산출물 포맷 계약)

에이전트 간 산출물의 필수 구조를 정의합니다.
다음 단계 에이전트가 파싱할 수 있도록 포맷을 준수해야 합니다.

---

## .omc/context/codebase.md (researcher → 전체)

```markdown
# 코드베이스 분석

## 프로젝트 구조
<!-- 디렉토리 트리 (depth 2) -->

## 기술 스택
<!-- 프레임워크, 언어, 주요 라이브러리, 버전 -->

## 컨벤션
<!-- 네이밍, 파일 구조 패턴, 상태 관리, API 패턴 -->

## 관련 파일
<!-- 현재 작업과 관련된 기존 코드 경로 + 1줄 설명 -->

## 재사용 가능
<!-- 기존 컴포넌트/훅/유틸 중 활용 가능한 것 -->

## 주의사항
<!-- 현재 코드의 제약, 기술 부채, 알려진 이슈 -->
```

---

## .omc/notepads/requirements.md (analyst → planner, 구현 에이전트)

```markdown
# 요구사항 분석

## 기능 요구사항
<!-- 필수(Must), 권장(Should), 선택(Could) 구분 -->
### Must
- [ ] 항목
### Should
- [ ] 항목
### Could
- [ ] 항목

## 비기능 요구사항
<!-- 성능, 보안, 접근성 등 -->

## 엣지케이스
<!-- 예외 상황, 경계값, 동시성 이슈 -->

## 제약 조건
<!-- 기술적/비즈니스 제약 -->

## 미결 사항
<!-- 사용자 확인이 필요한 항목 -->
```

---

## .omc/plans/current.md (planner → 구현 에이전트)

```markdown
# 작업 계획: [제목]

## 목표
<!-- 1-2문장 -->

## 단계

### Phase 1: [이름]
<!-- (병렬 가능) 또는 (순차) 명시 -->
- [ ] **[에이전트명]** 구체적 작업 설명
  - 입력: [필요한 정보/파일]
  - 출력: [생성할 파일/변경 사항]

### Phase 2: [이름]
- [ ] **[에이전트명]** 구체적 작업 설명

### Phase 3: 검증
- [ ] **[unit-tester]** 테스트 대상 명시
- [ ] **[code-reviewer]** 리뷰 관점 명시

## 의존성
<!-- Phase 간 의존 관계 한 줄 -->

## 파일 영향 범위
<!-- 생성/수정 예상 파일 목록 -->
```

---

## .omc/decisions/code-review.md (code-reviewer → 오케스트레이터)

```markdown
# 코드 리뷰 결과

## 요약
<!-- PASS / FAIL / CONDITIONAL PASS -->
<!-- Critical: N개, Major: N개, Minor: N개 -->

## Critical (즉시 수정 필수)
### [번호]. [제목]
- **파일**: path:line
- **문제**: 구체적 설명
- **수정안**: 코드 또는 방법 제시

## Major (수정 권장)
### [번호]. [제목]
- **파일**: path:line
- **문제**: 구체적 설명
- **수정안**: 코드 또는 방법 제시

## Minor (개선 제안)
- 항목 나열

## 긍정적 사항
- 잘된 점 나열
```

---

## .omc/decisions/architecture-review.md (architect → 오케스트레이터)

```markdown
# 아키텍처 리뷰 결과

## 요약
<!-- APPROVED / NEEDS_REVISION / REJECTED -->

## 구조 평가
<!-- 현재 구조의 적절성 -->

## 확장성
<!-- 향후 변경 대응 가능성 -->

## 위험 요소
### [번호]. [제목]
- **영향**: 구체적 설명
- **권장사항**: 대안 제시

## 승인 조건
<!-- NEEDS_REVISION인 경우, 수정 후 승인 가능 조건 -->
```

---

## .omc/artifacts/prd.md (pm → planner, designer)

```markdown
# PRD: [제품/기능명]

## 개요
<!-- 한 문단으로 요약 -->

## 목표
<!-- 정량적 목표 포함 -->

## 사용자 스토리
### [페르소나] 로서 [행동] 을 하여 [가치] 를 얻는다
- 인수 조건:
  - [ ] 조건1
  - [ ] 조건2

## 기능 명세
### [기능명]
- 설명:
- 입력:
- 출력:
- 예외:

## 우선순위
| 기능 | 우선순위 | 근거 |
|------|----------|------|

## 범위 제외
<!-- 이번에 하지 않는 것 명시 -->
```

---

## .omc/notepads/unit-tests.md (unit-tester → code-reviewer)

```markdown
# 유닛 테스트 결과

## 요약
- 실행: N개
- 성공: N개
- 실패: N개
- 커버리지: N%

## 테스트 파일
| 파일 | 테스트 수 | 결과 |
|------|----------|------|

## 실패 상세 (있을 경우)
### [테스트명]
- **파일**: path:line
- **기대값**: ...
- **실제값**: ...
- **원인 추정**: ...
```

---

## .omc/workflow-state.md (오케스트레이터 전용)

> 오케스트레이터가 매 Phase 전환 시 업데이트합니다.
> 에이전트는 이 파일을 읽지 않습니다.

```markdown
# Workflow State

## 현재 실행
- **명령**: autopilot / compose / parallel
- **요청**: [사용자의 원래 요청 1줄 요약]
- **시작**: [타임스탬프 또는 세션 식별]

## Phase 진행
- [x] Phase 1: 분석 (commit: abc1234)
- [x] Phase 2: 설계 (commit: def5678)
- [ ] Phase 3: 구현 ← 현재
- [ ] Phase 4: 검증

## 에이전트 호출 기록
| # | 에이전트 | 작업 | 결과 | max_turns |
|---|----------|------|------|-----------|
| 1 | researcher | 코드베이스 분석 | 완료 | 15 |
| 2 | analyst | 요구사항 도출 | 완료 | 15 |
| 3 | planner | 작업 계획 | 완료 | 15 |
| 4 | frontend | UI 구현 | 진행중 | 25 |

## 재시도 카운터
<!-- 같은 에이전트+같은 이유로 재호출된 횟수 -->
| 에이전트 | 사유 | 횟수 | 한도 |
|----------|------|------|------|
| frontend | code-review Critical | 1 | 2 |

## 비용 가드
- **총 에이전트 호출**: 4 / 15
- **피드백 루프 횟수**: 0 / 3
- **한도 초과 시**: 사용자 확인 요청

## 롤백 포인트
<!-- Phase 완료 시 자동 커밋된 해시 -->
| Phase | Commit | 복원 명령 |
|-------|--------|-----------|
| Phase 1 | abc1234 | git reset --hard abc1234 |
| Phase 2 | def5678 | git reset --hard def5678 |
```
